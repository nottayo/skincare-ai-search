{"version":3,"file":"dynamic-checkout-widget.mjs","sources":["../node_modules/react/cjs/react-jsx-runtime.production.min.js","../node_modules/react/jsx-runtime.js","../src/components/DynamicCheckout.jsx","../src/components/dynamic-checkout-widget.jsx"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","import React, { useState, useEffect, useRef } from 'react';\nimport './DynamicCheckout.css';\n\nconst DynamicCheckout = () => {\n  const [cartItems, setCartItems] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [cartUrl, setCartUrl] = useState('');\n  const [showTooltip, setShowTooltip] = useState(false);\n  const [lastCartState, setLastCartState] = useState([]);\n  const intervalRef = useRef(null);\n\n  // Monitor cart changes\n  useEffect(() => {\n    const checkCart = () => {\n      fetch('/cart.js')\n        .then(res => res.json())\n        .then(cart => {\n          const currentCartItems = cart.items || [];\n          const currentCartIds = currentCartItems.map(item => item.id).sort();\n          const lastCartIds = lastCartState.map(item => item.id).sort();\n          \n          // Check if cart actually changed\n          if (JSON.stringify(currentCartIds) !== JSON.stringify(lastCartIds)) {\n            setCartItems(currentCartItems);\n            setLastCartState(currentCartItems);\n            \n            // Create cart page if items exist\n            if (currentCartItems.length > 0) {\n              createCartPage(currentCartItems);\n            } else {\n              setCartUrl('');\n            }\n          }\n        })\n        .catch(error => {\n          console.error('Error fetching cart:', error);\n        });\n    };\n\n    // Check cart immediately\n    checkCart();\n\n    // Set up interval to check cart every 30 seconds\n    intervalRef.current = setInterval(checkCart, 30000);\n\n    return () => {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    };\n  }, [lastCartState]);\n\n  const createCartPage = async (items) => {\n    if (items.length === 0) return;\n    \n    setIsLoading(true);\n    try {\n      const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';\n      const API_URL = isLocalhost\n        ? 'http://localhost:10000/api/cart/create'\n        : 'https://skincare-ai-backend.onrender.com/api/cart/create';\n      \n      const response = await fetch(API_URL, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          items: items,\n          user_info: {\n            user_agent: navigator.userAgent,\n            timestamp: new Date().toISOString(),\n            source: 'dynamic_checkout_widget'\n          }\n        })\n      });\n      \n      if (response.ok) {\n        const cartData = await response.json();\n        const fullCartUrl = `${window.location.origin}${cartData.cart_url}`;\n        setCartUrl(fullCartUrl);\n      }\n    } catch (error) {\n      console.error('Error creating cart page:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleCheckoutClick = () => {\n    if (cartUrl) {\n      window.open(cartUrl, '_blank');\n    }\n  };\n\n  const copyCartLink = async () => {\n    if (cartUrl) {\n      try {\n        await navigator.clipboard.writeText(cartUrl);\n        setShowTooltip(true);\n        setTimeout(() => setShowTooltip(false), 2000);\n      } catch (error) {\n        console.error('Failed to copy link:', error);\n      }\n    }\n  };\n\n  const getTotalItems = () => {\n    return cartItems.reduce((total, item) => total + (item.quantity || 1), 0);\n  };\n\n  const getTotalPrice = () => {\n    return cartItems.reduce((total, item) => total + (item.final_price || 0), 0) / 100;\n  };\n\n  // Don't render if no items in cart\n  if (cartItems.length === 0) {\n    return null;\n  }\n\n  return (\n    <div className=\"dynamic-checkout-widget\">\n      <div className=\"checkout-button-container\">\n        <button \n          className=\"dynamic-checkout-btn\"\n          onClick={handleCheckoutClick}\n          disabled={isLoading || !cartUrl}\n        >\n          {isLoading ? (\n            <span className=\"loading-spinner\">‚è≥</span>\n          ) : (\n            <>\n              <span className=\"checkout-icon\">üõí</span>\n              <span className=\"checkout-text\">\n                Here is my cart ({getTotalItems()} items)\n              </span>\n            </>\n          )}\n        </button>\n        \n        {cartUrl && (\n          <button \n            className=\"copy-link-btn\"\n            onClick={copyCartLink}\n            title=\"Copy cart link\"\n          >\n            üìã\n          </button>\n        )}\n      </div>\n      \n      {showTooltip && (\n        <div className=\"tooltip\">\n          Cart link copied! üìã\n        </div>\n      )}\n      \n      <div className=\"cart-summary\">\n        <div className=\"summary-item\">\n          <span className=\"summary-label\">Items:</span>\n          <span className=\"summary-value\">{getTotalItems()}</span>\n        </div>\n        <div className=\"summary-item\">\n          <span className=\"summary-label\">Total:</span>\n          <span className=\"summary-value\">${getTotalPrice().toFixed(2)}</span>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default DynamicCheckout; ","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport DynamicCheckout from './DynamicCheckout';\nimport './DynamicCheckout.css';\n\n// Widget initialization function\nwindow.initDynamicCheckout = function(containerId = 'dynamic-checkout-container') {\n  // Create container if it doesn't exist\n  let container = document.getElementById(containerId);\n  if (!container) {\n    container = document.createElement('div');\n    container.id = containerId;\n    document.body.appendChild(container);\n  }\n\n  // Render the widget\n  ReactDOM.render(\n    <React.StrictMode>\n      <DynamicCheckout />\n    </React.StrictMode>,\n    container\n  );\n\n  // Return cleanup function\n  return function() {\n    ReactDOM.unmountComponentAtNode(container);\n    if (container.parentNode) {\n      container.parentNode.removeChild(container);\n    }\n  };\n};\n\n// Auto-initialize if script is loaded directly\nif (typeof document !== 'undefined') {\n  // Wait for DOM to be ready\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', () => {\n      window.initDynamicCheckout();\n    });\n  } else {\n    window.initDynamicCheckout();\n  }\n}\n\n// Export for module systems\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = { initDynamicCheckout: window.initDynamicCheckout };\n} "],"names":["jsxRuntimeModule","require$$0","jsxs","jsx","Fragment","React"],"mappings":"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","x_google_ignoreList":[0,1]}