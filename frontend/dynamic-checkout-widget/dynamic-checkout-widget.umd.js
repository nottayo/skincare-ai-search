!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).React,e.ReactDOM)}(this,function(e,t){"use strict";var n,a,i={exports:{}},c={};var o=(a||(a=1,i.exports=function(){if(n)return c;n=1;var t=e,a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,r=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,n){var i,c={},d=null,l=null;for(i in void 0!==n&&(d=""+n),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,i)&&!s.hasOwnProperty(i)&&(c[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===c[i]&&(c[i]=t[i]);return{$$typeof:a,type:e,key:d,ref:l,props:c,_owner:r.current}}return c.Fragment=i,c.jsx=d,c.jsxs=d,c}()),i.exports);const r=()=>{const[t,n]=e.useState([]),[a,i]=e.useState(!1),[c,r]=e.useState(""),[s,d]=e.useState(!1),[l,u]=e.useState([]),m=e.useRef(null);e.useEffect(()=>{const e=()=>{fetch("/cart.js").then(e=>e.json()).then(e=>{const t=e.items||[],a=t.map(e=>e.id).sort(),i=l.map(e=>e.id).sort();JSON.stringify(a)!==JSON.stringify(i)&&(n(t),u(t),t.length>0?h(t):r(""))}).catch(e=>{})};return e(),m.current=setInterval(e,3e4),()=>{m.current&&clearInterval(m.current)}},[l]);const h=async e=>{if(0!==e.length){i(!0);try{const t="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"http://localhost:10000/api/cart/create":"https://skincare-ai-backend.onrender.com/api/cart/create",n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:e,user_info:{user_agent:navigator.userAgent,timestamp:(new Date).toISOString(),source:"dynamic_checkout_widget"}})});if(n.ok){const e=await n.json(),t=`${window.location.origin}${e.cart_url}`;r(t)}}catch(t){}finally{i(!1)}}},p=()=>t.reduce((e,t)=>e+(t.quantity||1),0);return 0===t.length?null:o.jsxs("div",{className:"dynamic-checkout-widget",children:[o.jsxs("div",{className:"checkout-button-container",children:[o.jsx("button",{className:"dynamic-checkout-btn",onClick:()=>{c&&window.open(c,"_blank")},disabled:a||!c,children:a?o.jsx("span",{className:"loading-spinner",children:"â³"}):o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"checkout-icon",children:"ðŸ›’"}),o.jsxs("span",{className:"checkout-text",children:["Here is my cart (",p()," items)"]})]})}),c&&o.jsx("button",{className:"copy-link-btn",onClick:async()=>{if(c)try{await navigator.clipboard.writeText(c),d(!0),setTimeout(()=>d(!1),2e3)}catch(e){}},title:"Copy cart link",children:"ðŸ“‹"})]}),s&&o.jsx("div",{className:"tooltip",children:"Cart link copied! ðŸ“‹"}),o.jsxs("div",{className:"cart-summary",children:[o.jsxs("div",{className:"summary-item",children:[o.jsx("span",{className:"summary-label",children:"Items:"}),o.jsx("span",{className:"summary-value",children:p()})]}),o.jsxs("div",{className:"summary-item",children:[o.jsx("span",{className:"summary-label",children:"Total:"}),o.jsxs("span",{className:"summary-value",children:["$",(t.reduce((e,t)=>e+(t.final_price||0),0)/100).toFixed(2)]})]})]})]})};window.initDynamicCheckout=function(n="dynamic-checkout-container"){let a=document.getElementById(n);return a||(a=document.createElement("div"),a.id=n,document.body.appendChild(a)),t.render(o.jsx(e.StrictMode,{children:o.jsx(r,{})}),a),function(){t.unmountComponentAtNode(a),a.parentNode&&a.parentNode.removeChild(a)}},"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{window.initDynamicCheckout()}):window.initDynamicCheckout()),"undefined"!=typeof module&&module.exports&&(module.exports={initDynamicCheckout:window.initDynamicCheckout})});
//# sourceMappingURL=dynamic-checkout-widget.umd.js.map
