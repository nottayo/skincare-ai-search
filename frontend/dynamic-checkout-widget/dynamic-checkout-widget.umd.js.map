{"version":3,"file":"dynamic-checkout-widget.umd.js","sources":["../node_modules/react/jsx-runtime.js","../node_modules/react/cjs/react-jsx-runtime.production.min.js","../src/components/DynamicCheckout.jsx","../src/components/dynamic-checkout-widget.jsx"],"sourcesContent":["'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","import React, { useState, useEffect, useRef } from 'react';\nimport './DynamicCheckout.css';\n\nconst DynamicCheckout = () => {\n  const [cartItems, setCartItems] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [cartUrl, setCartUrl] = useState('');\n  const [showTooltip, setShowTooltip] = useState(false);\n  const [lastCartState, setLastCartState] = useState([]);\n  const intervalRef = useRef(null);\n\n  // Monitor cart changes\n  useEffect(() => {\n    const checkCart = () => {\n      fetch('/cart.js')\n        .then(res => res.json())\n        .then(cart => {\n          const currentCartItems = cart.items || [];\n          const currentCartIds = currentCartItems.map(item => item.id).sort();\n          const lastCartIds = lastCartState.map(item => item.id).sort();\n          \n          // Check if cart actually changed\n          if (JSON.stringify(currentCartIds) !== JSON.stringify(lastCartIds)) {\n            setCartItems(currentCartItems);\n            setLastCartState(currentCartItems);\n            \n            // Create cart page if items exist\n            if (currentCartItems.length > 0) {\n              createCartPage(currentCartItems);\n            } else {\n              setCartUrl('');\n            }\n          }\n        })\n        .catch(error => {\n          console.error('Error fetching cart:', error);\n        });\n    };\n\n    // Check cart immediately\n    checkCart();\n\n    // Set up interval to check cart every 30 seconds\n    intervalRef.current = setInterval(checkCart, 30000);\n\n    return () => {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    };\n  }, [lastCartState]);\n\n  const createCartPage = async (items) => {\n    if (items.length === 0) return;\n    \n    setIsLoading(true);\n    try {\n      const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';\n      const API_URL = isLocalhost\n        ? 'http://localhost:10000/api/cart/create'\n        : 'https://skincare-ai-backend.onrender.com/api/cart/create';\n      \n      const response = await fetch(API_URL, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          items: items,\n          user_info: {\n            user_agent: navigator.userAgent,\n            timestamp: new Date().toISOString(),\n            source: 'dynamic_checkout_widget'\n          }\n        })\n      });\n      \n      if (response.ok) {\n        const cartData = await response.json();\n        const fullCartUrl = `${window.location.origin}${cartData.cart_url}`;\n        setCartUrl(fullCartUrl);\n      }\n    } catch (error) {\n      console.error('Error creating cart page:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleCheckoutClick = () => {\n    if (cartUrl) {\n      window.open(cartUrl, '_blank');\n    }\n  };\n\n  const copyCartLink = async () => {\n    if (cartUrl) {\n      try {\n        await navigator.clipboard.writeText(cartUrl);\n        setShowTooltip(true);\n        setTimeout(() => setShowTooltip(false), 2000);\n      } catch (error) {\n        console.error('Failed to copy link:', error);\n      }\n    }\n  };\n\n  const getTotalItems = () => {\n    return cartItems.reduce((total, item) => total + (item.quantity || 1), 0);\n  };\n\n  const getTotalPrice = () => {\n    return cartItems.reduce((total, item) => total + (item.final_price || 0), 0) / 100;\n  };\n\n  // Don't render if no items in cart\n  if (cartItems.length === 0) {\n    return null;\n  }\n\n  return (\n    <div className=\"dynamic-checkout-widget\">\n      <div className=\"checkout-button-container\">\n        <button \n          className=\"dynamic-checkout-btn\"\n          onClick={handleCheckoutClick}\n          disabled={isLoading || !cartUrl}\n        >\n          {isLoading ? (\n            <span className=\"loading-spinner\">‚è≥</span>\n          ) : (\n            <>\n              <span className=\"checkout-icon\">üõí</span>\n              <span className=\"checkout-text\">\n                Here is my cart ({getTotalItems()} items)\n              </span>\n            </>\n          )}\n        </button>\n        \n        {cartUrl && (\n          <button \n            className=\"copy-link-btn\"\n            onClick={copyCartLink}\n            title=\"Copy cart link\"\n          >\n            üìã\n          </button>\n        )}\n      </div>\n      \n      {showTooltip && (\n        <div className=\"tooltip\">\n          Cart link copied! üìã\n        </div>\n      )}\n      \n      <div className=\"cart-summary\">\n        <div className=\"summary-item\">\n          <span className=\"summary-label\">Items:</span>\n          <span className=\"summary-value\">{getTotalItems()}</span>\n        </div>\n        <div className=\"summary-item\">\n          <span className=\"summary-label\">Total:</span>\n          <span className=\"summary-value\">${getTotalPrice().toFixed(2)}</span>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default DynamicCheckout; ","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport DynamicCheckout from './DynamicCheckout';\nimport './DynamicCheckout.css';\n\n// Widget initialization function\nwindow.initDynamicCheckout = function(containerId = 'dynamic-checkout-container') {\n  // Create container if it doesn't exist\n  let container = document.getElementById(containerId);\n  if (!container) {\n    container = document.createElement('div');\n    container.id = containerId;\n    document.body.appendChild(container);\n  }\n\n  // Render the widget\n  ReactDOM.render(\n    <React.StrictMode>\n      <DynamicCheckout />\n    </React.StrictMode>,\n    container\n  );\n\n  // Return cleanup function\n  return function() {\n    ReactDOM.unmountComponentAtNode(container);\n    if (container.parentNode) {\n      container.parentNode.removeChild(container);\n    }\n  };\n};\n\n// Auto-initialize if script is loaded directly\nif (typeof document !== 'undefined') {\n  // Wait for DOM to be ready\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', () => {\n      window.initDynamicCheckout();\n    });\n  } else {\n    window.initDynamicCheckout();\n  }\n}\n\n// Export for module systems\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = { initDynamicCheckout: window.initDynamicCheckout };\n} "],"names":["jsxRuntimeModule","exports","f","require$$0","k","Symbol","for","l","m","Object","prototype","hasOwnProperty","n","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","ReactCurrentOwner","p","key","ref","__self","__source","q","c","a","g","b","d","e","h","call","defaultProps","$$typeof","type","props","_owner","current","reactJsxRuntime_production_min","jsx","jsxs","DynamicCheckout","cartItems","setCartItems","useState","isLoading","setIsLoading","cartUrl","setCartUrl","showTooltip","setShowTooltip","lastCartState","setLastCartState","intervalRef","useRef","useEffect","checkCart","fetch","then","res","json","cart","currentCartItems","items","currentCartIds","map","item","id","sort","lastCartIds","JSON","stringify","length","createCartPage","catch","error","setInterval","clearInterval","async","API_URL","window","location","hostname","response","method","headers","body","user_info","user_agent","navigator","userAgent","timestamp","Date","toISOString","source","ok","cartData","fullCartUrl","origin","cart_url","getTotalItems","reduce","total","quantity","className","children","onClick","open","disabled","Fragment","clipboard","writeText","setTimeout","title","final_price","toFixed","initDynamicCheckout","containerId","container","document","getElementById","createElement","appendChild","ReactDOM","render","React","StrictMode","unmountComponentAtNode","parentNode","removeChild","readyState","addEventListener","module"],"mappings":"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","x_google_ignoreList":[0,1]}